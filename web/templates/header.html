{% set header_user = current_user if (current_user is defined and current_user) else (user if user is defined else None) %}
{% set header_role = current_role_name if current_role_name is defined else (role_name if role_name is defined else '') %}
<div class="top-left">
    <a href="/" class="logo">ü¶Å</a>
    <a href="{{ APP_BASE_URL }}" class="project-name">{{ APP_BRAND_NAME }}</a>
</div>
<div class="top-center">
    <h2 class="page-title">{{ page_title }}</h2>
</div>
<div class="top-right">
    <div class="bot-menu"><a href="{{ BOT_LANDING_URL }}" target="_blank">Bot</a></div>
    {% if header_user %}
        <div id="compact-toggle" class="profile-icon">üóú</div>
        {% if is_admin %}
        <div class="admin-menu"><a href="/admin">–ê–¥–º–∏–Ω</a></div>
        {% endif %}
        <div class="profile-menu">
            <div id="profile-button" class="profile-icon role-{{ header_role|lower }}">üë§</div>
            <div id="profile-dropdown" class="dropdown-menu hidden">
                <div class="role">
                    –†–æ–ª—å:
                    <button type="button" class="role-badge" data-role="{{ header_role }}">{{ header_role }}</button>
                </div>
                {% if header_user.telegram_id is defined %}
                <a href="/profile/{{ header_user.telegram_id }}">–ü—Ä–æ—Ñ–∏–ª—å</a>
                {% else %}
                <a href="/profile/{{ header_user.username }}">–ü—Ä–æ—Ñ–∏–ª—å</a>
                {% endif %}
                <a href="/settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
                <a href="/auth/logout" data-method="post">–í—ã–π—Ç–∏</a>
            </div>
        </div>
    {% else %}
        <nav class="guest-menu">
            <a href="/auth/login">–í—Ö–æ–¥</a>
            <a href="/auth/register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
        </nav>
    {% endif %}
</div>
