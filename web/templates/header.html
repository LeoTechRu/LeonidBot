{% set header_user = current_user if (current_user is defined and current_user) else (user if user is defined else None) %}
{% set header_role = current_role_name if current_role_name is defined else (role_name if role_name is defined else '') %}
<header class="app-header" role="banner">
  <div class="brand-wrap">
    <a class="brand" href="/">
      <img class="brand-mark" src="{{ url_for('static', path='img/brand/leonidpro-mark.svg') }}" alt="LeonidPro" width="22" height="22" loading="lazy">
      <span class="brand-type">LeonidPro</span>
    </a>
  </div>

  <nav class="app-nav" aria-label="–ú–æ–¥—É–ª–∏">
    <ul class="nav-list">
      <li><button type="button" class="nav-pill" data-widget="tasks" aria-haspopup="dialog">–ó–∞–¥–∞—á–∏</button></li>
      <li><button type="button" class="nav-pill" data-widget="rc" aria-haspopup="dialog">–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è/–ö–∞–ª–µ–Ω–¥–∞—Ä—å</button></li>
      <li><button type="button" class="nav-pill" data-widget="notes" aria-haspopup="dialog">–ó–∞–º–µ—Ç–∫–∏</button></li>
    </ul>
  </nav>

  <div class="actions">
    <a class="icon-btn" href="{{ BOT_LANDING_URL }}" aria-label="Bot"><svg class="icon-24"><use href="#i-telegram"/></svg></a>
    <button class="icon-btn timer-btn" id="timerToggle" aria-label="–¢–∞–π–º–µ—Ä"><svg class="icon-24"><use href="#i-clock"/></svg><span class="timer-dot" hidden></span></button>
    <button class="icon-btn hamburger" id="navHamburger" aria-label="–ú–µ–Ω—é" hidden><svg class="icon-24"><use href="#i-menu"/></svg></button>
    {# –ø—Ä–æ—Ñ–∏–ª—å –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ #}
    <div class="profile-menu">
      <div id="profile-button" class="profile-icon role-{{ header_role|lower }}">üë§</div>
      <div id="profile-dropdown" class="dropdown-menu hidden">
        <div class="role">
          –†–æ–ª—å:
          <button type="button" class="role-badge" data-role="{{ header_role }}">{{ header_role }}</button>
        </div>
        {% if header_user and header_user.telegram_id is defined %}
        <a href="/profile/{{ header_user.telegram_id }}">–ü—Ä–æ—Ñ–∏–ª—å</a>
        {% elif header_user %}
        <a href="/profile/{{ header_user.username }}">–ü—Ä–æ—Ñ–∏–ª—å</a>
        {% else %}
        <a href="/auth">–í—Ö–æ–¥</a>
        {% endif %}
        <a href="/settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
        {% if is_admin %}
        <a href="/admin">–ê–¥–º–∏–Ω</a>
        {% endif %}
        {% if header_user %}
        <a href="/auth/logout" data-method="post">–í—ã–π—Ç–∏</a>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="hamburger-menu" id="navDrawer" hidden></div>
</header>

{# –ø–æ–¥–∫–ª—é—á–∞–µ–º –ø–æ–ø–æ–≤–µ—Ä—ã-–≤–∏–¥–∂–µ—Ç—ã –∏ —Ç–∞–π–º–µ—Ä, –µ—Å–ª–∏ –µ—â—ë –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã #}
{% include "_widget_tasks_today.html" %}
{% include "_widget_rc_today.html" %}
{% include "_widget_notes_quick.html" %}
{% include "_timer_widget.html" %}
