{% extends "layout.html" %}
{% block title %}Профиль{% endblock %}
{% block content %}
<header class="top-bar">
    <h1 class="welcome"><a href="/">Профиль</a></h1>
</header>
<div class="ui-layout">
    {% if editing %}
    <form class="ui-form" method="post" action="/profile/{{ user.telegram_id }}">
        <label>Имя</label>
        <input type="text" name="first_name" value="{{ user.first_name }}" required>
        <label>Фамилия</label>
        <input type="text" name="last_name" value="{{ user.last_name or '' }}">
        <label>Username</label>
        <input type="text" name="username" value="{{ user.username or '' }}">
        <label>День рождения</label>
        <input type="date" name="birthday" value="{{ user.birthday or '' }}">
        <label>Язык</label>
        <input type="text" name="language_code" value="{{ user.language_code or '' }}">
        <label>Email</label>
        <input type="email" name="email" value="{{ user.email or '' }}">
        <label>Телефон</label>
        <input type="text" name="phone" value="{{ user.phone or '' }}">
        <button type="submit" class="button">Сохранить</button>
        <button type="button" class="button" onclick="location.href='/profile/{{ user.telegram_id }}'">Отменить</button>
    </form>
    {% else %}
    <h2>{{ user.first_name }} {{ user.last_name or '' }}</h2>
    <p><strong>Username:</strong> @{{ user.username or '' }}</p>
    <p><strong>День рождения:</strong> {{ user.birthday or 'не указано' }}</p>
    <p><strong>Язык:</strong> {{ user.language_code or 'не указан' }}</p>
    <p><strong>Роль:</strong> {{ role_name }}</p>
    {% if groups %}
    <h2>Ваши группы</h2>
    <ul class="ui-table">
        {% for g in groups %}<li>{{ g.title }}</li>{% endfor %}
    </ul>
    {% else %}
    <p>Группы отсутствуют.</p>
    {% endif %}
    <button class="button" onclick="location.href='/profile/{{ user.telegram_id }}?edit=true'">Редактировать</button>
    {% endif %}
</div>
{% endblock %}
