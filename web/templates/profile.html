{% extends "layout.html" %}
{% block title %}–ü—Ä–æ—Ñ–∏–ª—å{% endblock %}
{% block content %}
<header class="top-bar">
    <div class="top-left">
        <h1 class="welcome"><a href="/">–ü—Ä–∏–≤–µ—Ç, {{ current_user.first_name }}!</a></h1>
    </div>
    <div class="top-center">
        <h2 class="page-title">{{ page_title }}</h2>
    </div>
    <div class="top-right">
        {% if is_admin %}
        <div class="admin-menu">
            <div id="admin-button">–ê–¥–º–∏–Ω</div>
            <div id="admin-dropdown" class="dropdown-menu hidden">
                <a href="#" data-admin-endpoint="/admin/users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
                <a href="#" data-admin-endpoint="/admin/groups">–ì—Ä—É–ø–ø—ã</a>
                <a href="#" data-admin-endpoint="/admin/settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
            </div>
        </div>
        {% endif %}
        <div class="profile-menu">
            <div id="profile-button" class="profile-icon role-{{ current_role_name|lower }}">üë§</div>
            <div id="profile-dropdown" class="dropdown-menu hidden">
                <div class="role">–†–æ–ª—å: {{ current_role_name }}</div>
                <a href="/profile/{{ current_user.telegram_id }}">–ü—Ä–æ—Ñ–∏–ª—å</a>
                <a href="/settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
                <a href="/auth/logout" data-method="post">–í—ã–π—Ç–∏</a>
            </div>
        </div>
    </div>
</header>
<div class="ui-layout">
    <div id="main-content">
        {% if editing %}
        <form class="ui-form" method="post" action="/profile/{{ user.telegram_id }}">
            <label>–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è</label>
            <input type="text" name="full_display_name" value="{{ user.full_display_name or '' }}">
            <label>–ò–º—è</label>
            <input type="text" name="first_name" value="{{ user.first_name }}" required>
            <label>–§–∞–º–∏–ª–∏—è</label>
            <input type="text" name="last_name" value="{{ user.last_name or '' }}">
            <label>Username</label>
            <input type="text" name="username" value="{{ user.username or '' }}">
            <label>Email</label>
            <input type="email" name="email" value="{{ user.email or '' }}">
            <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
            <input type="text" name="phone" value="{{ user.phone or '' }}">
            <label>–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è</label>
            <input type="date" name="birthday" value="{{ user.birthday.strftime('%Y-%m-%d') if user.birthday else '' }}">
            <label>–Ø–∑—ã–∫</label>
            <input type="text" name="language_code" value="{{ user.language_code or '' }}">
            <button type="submit" class="button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button type="button" class="button" onclick="location.href='/profile/{{ user.telegram_id }}'">–û—Ç–º–µ–Ω–∞</button>
        </form>
        {% else %}
        <p><strong>–ò–º—è:</strong> {{ info.display_name }}</p>
        <p><strong>Telegram ID:</strong> {{ info.telegram_id }}</p>
        <p><strong>Username:</strong> {{ info.username or '–Ω–µ —É–∫–∞–∑–∞–Ω' }}</p>
        <p><strong>Email:</strong> {{ info.email or '–Ω–µ —É–∫–∞–∑–∞–Ω–æ' }}</p>
        <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ info.phone or '–Ω–µ —É–∫–∞–∑–∞–Ω' }}</p>
        <p><strong>–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> {{ info.birthday or '–Ω–µ —É–∫–∞–∑–∞–Ω–æ' }}</p>
        <p><strong>–Ø–∑—ã–∫:</strong> {{ info.language_code or '–Ω–µ —É–∫–∞–∑–∞–Ω' }}</p>
        <p><strong>–†–æ–ª—å:</strong> {{ role_name }}</p>
        {% if groups %}
        <h3>–ì—Ä—É–ø–ø—ã</h3>
        <ul class="ui-table">
            {% for g in groups %}<li>{{ g.title }}</li>{% endfor %}
        </ul>
        {% else %}
        <p>–ì—Ä—É–ø–ø—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.</p>
        {% endif %}
        <button class="button" onclick="location.href='/profile/{{ user.telegram_id }}?edit=true'">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
        {% endif %}
    </div>
</div>
{% endblock %}
