# LeonidBot
- Пет-проект для изучения возможностей Telegram-ботов. [LeonidBot.t.me](https://LeonidBot.t.me)
- Бот должен включать в себя различные полезные утилиты (таск-система, тайм-менеджер, интеграции с календарями, напоминалки, управление TG-группами)
- Для усложнения задачи поставил себе цель прикрутить веб-морду с авторизацией через Telegram.
- В качестве веб морды буду использовать Flask/FastApi/Django.

## Configuration

Настройки проекта управляются через модуль `core.config`, использующий `pydantic` для чтения
переменных окружения или файла `.env` в корне репозитория.

Поддерживаемые переменные:

- `BOT_TOKEN` – токен Telegram-бота
- `DB_USER`, `DB_PASSWORD`, `DB_HOST`, `DB_NAME` – параметры подключения к БД
- `ADMIN_CHAT_ID` – чат для отправки уведомлений администратору

Пример файла `.env`:

```
BOT_TOKEN=123456:ABCDEF
DB_USER=user
DB_PASSWORD=pass
DB_HOST=localhost
DB_NAME=leonid
ADMIN_CHAT_ID=100500
```

Для доступа к значениям используйте:

```python
from core.config import settings

print(settings.bot_token)
```

## Backlog внедрения нового функционала:
- [x] Асинхронный бэкенд на aiogram и SQLAlchemy с подключением к PostgreSQL.
- [x] Определены модели пользователей, групп, каналов и настроек логирования.
- [x] Сервис `UserService` для работы с пользователями, группами и логированием.
- [x] Команды `/start`, `/cancel`, `/birthday`, `/contact` для взаимодействия с пользователем.
- [x] Команда `/group` для управления группами и декоратор проверки членства.
- [x] Логирование событий: middleware, пересылка неизвестных сообщений в группу логов, ответы админа, команды `/setloglevel` и `/getloglevel`.
- [x] Декоратор `role_required` для проверки ролей пользователей.
- [x] Заготовка FSM для обновления контактных данных и описания групп.
- [x] Каркас веб-приложения на FastAPI для работы через webhook.
- [ ] Каркас таск-системы.
- [ ] Каркас тайм-менеджера.
- [ ] Каркас системы напоминаний.
- [ ] Напоминания по таскам.
- [ ] Каркас работы с календарём.
- [ ] Интеграция с Google-календарём.
- [ ] Напоминания по Google-календарю.
- [ ] Реализовать команды `/setfullname`, `/setemail`, `/setphone`, `/setbirthday` и редактирование описаний групп.
- [ ] Веб-интерфейс с авторизацией через Telegram и админ-панелью.
- [ ] Рефакторинг сервисов и логирования, устранение дублирования кода, покрытие тестами.
- [ ] Разделение кода на модули и добавление миграций БД.
- [ ] Тесты и CI/CD для бота и веб-сервера
- [ ] Дополнительные модули: заметки, трекер привычек, учёт финансов, интеграция с внешними задачниками и календарями.
